<!DOCTYPE html>
<html>

<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">

<title>
    50Hz or 60Hz? - Falcon from hardware
</title>


<link rel="shortcut icon" href="/icon.ico">








<link rel="stylesheet" href="/css/main.min.3c9fa6b3264a9f8be4f27730f1d5f0ded496304d03812ed49d97703ffb28122a.css" integrity="sha256-PJ&#43;msyZKn4vk8ncw8dXw3tSWME0DgS7UnZdwP/soEio=" crossorigin="anonymous" media="screen">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="50Hz or 60Hz?"/>
<meta name="twitter:description" content="In my second job as a &lsquo;software engineer&rsquo;, my job was, mainly maintain and update existing firmwares.
I came across with a coffee machine that needs to be selling globally, rather than only some counties. My task was to update the part of the circuit and firmware that detects the AC main switching frequency.
Hardware A non-zero-crossing Triac and an optocoupler were chosen as the detection circuit. The MCU input pin is protected from high voltage by the optocoupler."/>

<meta property="og:title" content="50Hz or 60Hz?" />
<meta property="og:description" content="In my second job as a &lsquo;software engineer&rsquo;, my job was, mainly maintain and update existing firmwares.
I came across with a coffee machine that needs to be selling globally, rather than only some counties. My task was to update the part of the circuit and firmware that detects the AC main switching frequency.
Hardware A non-zero-crossing Triac and an optocoupler were chosen as the detection circuit. The MCU input pin is protected from high voltage by the optocoupler." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jklmf.github.io/posts/50_60_hz/" />
<meta property="article:published_time" content="2014-05-17T22:28:11+08:00" />
<meta property="article:modified_time" content="2014-05-17T22:28:11+08:00" />


    

    
    
    
    <title>
        
        50Hz or 60Hz?
        
    </title>
</head>

<body>
    
    
    <header class="wrap flex-container">
        <h1>50Hz or 60Hz?</h1>
    </header>
    
    <main class="wrap">
        
<div class="flex-container">
    <aside role="complementary">
        Sat May 17, 2014 &#183; 255 words
        <div class="tag-container">
            
        </div>
    </aside>
    <hr />
    <article role="article">
        <p>In my second job as a &lsquo;software engineer&rsquo;, my job was, mainly maintain and update existing firmwares.</p>
<p>I came across with a coffee machine that needs to be selling globally, rather than only some counties. My task was to update the part of the circuit and firmware that detects the AC main switching frequency.</p>
<h5 id="hardware">Hardware</h5>
<p>A non-zero-crossing Triac and an optocoupler were chosen as the detection circuit. The MCU input pin is protected from high voltage by the optocoupler. Whenever the AC signal crossing the zero, a small signal is output from the triac. A transistor will then amplify the pulses before feed in to the external interrupt pin of MCU.</p>
<h5 id="software">Software</h5>
<p>Whenever the machine boot, the timer for input capture will be initialised first. Then it counts the external pulses from the pin.</p>
<p>After a window of sampling time, 50Hz or 60Hz will be determinded by the average of captured period (i.e. 1/f) of the frequency. Once the AC main frequency is known, the software then utilize it to help on some non-time-critical tasks such as button press or brightness control.</p>
<h5 id="ac-line-fail">AC line fail&hellip;</h5>
<p>A unstable AC frequency protection was also added in this firmware update. The logic is that, when the AC frequency failed alternating certain times continuously, machine will enter a protection mode, just like sleep mode. All the state will be saved, all MCU peripherals will be stopped.</p>
<p>In order to protect the motor and other behaviours, machine will only allow to exit this mode if user re-plug the power cord.</p>

    </article>
</div>


        
<nav role="navigation" class="flex-container bottom-menu">
    
<hr />
<p>


    
        <a href="/posts">back</a>
        
            &#183;
        
    

    
        
            <a href="/posts">posts</a>
        
    
    
        
            &#183; 
            <a href="/gallery">gallery</a>
        
            &#183; 
            <a href="/about">Falcon in hardware</a>
        
            &#183; 
            <a href="https://www.linkedin.com/in/falcon-lmf-44050665/">linkedin</a>
        
            &#183; 
            <a href="https://github.com/falconlmf/">&lt;/&gt; github</a>
        
    
    &#183; 
    <a href="/">
        main
    </a>

</p>
</nav>

    </main>
    
    <footer class="flex-container footer"><a href="mailto:lmf.falcon@gmail.com">lmf.falcon@gmail.com</a></footer>
    
    
</body>

</html>